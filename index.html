<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="main.css"></head>
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <title>site</title>
  </head>
  <body>
    <div id="app">
      <div class="stats">
        <div clas="team-1">
          <h2>
            <img src="img/logo.png" />
            Team Liquid
          </h2>
          <div class="stats-per-player">
            <div class="row">
              <div class="player">
                <h3>Kuroky</h3>
                <div class="player-name">Kuro Salehi Takhasomi</div>
              </div>
              <div class="player-icons">
                <img class="player-hero" src="img/heroes/lich_hphover.png" />
                <img class="player-item" src="img/items/ward_sentry_lg.png" />
                <img class="player-item" src="img/items/tranquil_boots_lg.png" />
                <img class="player-item" src="img/items/enchanted_mango_lg.png" />
                <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
                <img class="player-item" src="img/items/magic_wand_lg.png" />
                <img class="player-item" src="img/items/tpscroll_lg.png" />
              </div>
              <div class="player-kda">2/6/11</div>
            </div>
            <div class="row">
              <div class="player">
                <h3>Kuroky</h3>
                <div class="player-name">Kuro Salehi Takhasomi</div>
              </div>
              <div class="player-icons">
                <img class="player-hero" src="img/heroes/lich_hphover.png" />
                <img class="player-item" src="img/items/ward_sentry_lg.png" />
                <img class="player-item" src="img/items/tranquil_boots_lg.png" />
                <img class="player-item" src="img/items/enchanted_mango_lg.png" />
                <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
                <img class="player-item" src="img/items/magic_wand_lg.png" />
                <img class="player-item" src="img/items/tpscroll_lg.png" />
              </div>
              <div class="player-kda">2/6/11</div>
            </div>
            <div class="row">
              <div class="player">
                <h3>Kuroky</h3>
                <div class="player-name">Kuro Salehi Takhasomi</div>
              </div>
              <div class="player-icons">
                <img class="player-hero" src="img/heroes/lich_hphover.png" />
                <img class="player-item" src="img/items/ward_sentry_lg.png" />
                <img class="player-item" src="img/items/tranquil_boots_lg.png" />
                <img class="player-item" src="img/items/enchanted_mango_lg.png" />
                <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
                <img class="player-item" src="img/items/magic_wand_lg.png" />
                <img class="player-item" src="img/items/tpscroll_lg.png" />
              </div>
              <div class="player-kda">2/6/11</div>
            </div>
            <div class="row">
              <div class="player">
                <h3>Kuroky</h3>
                <div class="player-name">Kuro Salehi Takhasomi</div>
              </div>
              <div class="player-icons">
                <img class="player-hero" src="img/heroes/lich_hphover.png" />
                <img class="player-item" src="img/items/ward_sentry_lg.png" />
                <img class="player-item" src="img/items/tranquil_boots_lg.png" />
                <img class="player-item" src="img/items/enchanted_mango_lg.png" />
                <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
                <img class="player-item" src="img/items/magic_wand_lg.png" />
                <img class="player-item" src="img/items/tpscroll_lg.png" />
              </div>
              <div class="player-kda">2/6/11</div>
            </div>
            <div class="row">
              <div class="player">
                <h3>Kuroky</h3>
                <div class="player-name">Kuro Salehi Takhasomi</div>
              </div>
              <div class="player-icons">
                <img class="player-hero" src="img/heroes/lich_hphover.png" />
                <img class="player-item" src="img/items/ward_sentry_lg.png" />
                <img class="player-item" src="img/items/tranquil_boots_lg.png" />
                <img class="player-item" src="img/items/enchanted_mango_lg.png" />
                <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
                <img class="player-item" src="img/items/magic_wand_lg.png" />
                <img class="player-item" src="img/items/tpscroll_lg.png" />
              </div>
              <div class="player-kda">2/6/11</div>
            </div>
          </div>
        </div>
        <hr />
        <div class="team-2">
          <div class="row">
            <div class="player">
              <h3>Kuroky</h3>
              <div class="player-name">Kuro Salehi Takhasomi</div>
            </div>
            <div class="player-icons">
              <img class="player-hero" src="img/heroes/lich_hphover.png" />
              <img class="player-item" src="img/items/ward_sentry_lg.png" />
              <img class="player-item" src="img/items/tranquil_boots_lg.png" />
              <img class="player-item" src="img/items/enchanted_mango_lg.png" />
              <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
              <img class="player-item" src="img/items/magic_wand_lg.png" />
              <img class="player-item" src="img/items/tpscroll_lg.png" />
            </div>
            <div class="player-kda">2/6/11</div>
          </div>
          <div class="row">
            <div class="player">
              <h3>Kuroky</h3>
              <div class="player-name">Kuro Salehi Takhasomi</div>
            </div>
            <div class="player-icons">
              <img class="player-hero" src="img/heroes/lich_hphover.png" />
              <img class="player-item" src="img/items/ward_sentry_lg.png" />
              <img class="player-item" src="img/items/tranquil_boots_lg.png" />
              <img class="player-item" src="img/items/enchanted_mango_lg.png" />
              <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
              <img class="player-item" src="img/items/magic_wand_lg.png" />
              <img class="player-item" src="img/items/tpscroll_lg.png" />
            </div>
            <div class="player-kda">2/6/11</div>
          </div>
          <div class="row">
            <div class="player">
              <h3>Kuroky</h3>
              <div class="player-name">Kuro Salehi Takhasomi</div>
            </div>
            <div class="player-icons">
              <img class="player-hero" src="img/heroes/lich_hphover.png" />
              <img class="player-item" src="img/items/ward_sentry_lg.png" />
              <img class="player-item" src="img/items/tranquil_boots_lg.png" />
              <img class="player-item" src="img/items/enchanted_mango_lg.png" />
              <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
              <img class="player-item" src="img/items/magic_wand_lg.png" />
              <img class="player-item" src="img/items/tpscroll_lg.png" />
            </div>
            <div class="player-kda">2/6/11</div>
          </div>
          <div class="row">
            <div class="player">
              <h3>Kuroky</h3>
              <div class="player-name">Kuro Salehi Takhasomi</div>
            </div>
            <div class="player-icons">
              <img class="player-hero" src="img/heroes/lich_hphover.png" />
              <img class="player-item" src="img/items/ward_sentry_lg.png" />
              <img class="player-item" src="img/items/tranquil_boots_lg.png" />
              <img class="player-item" src="img/items/enchanted_mango_lg.png" />
              <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
              <img class="player-item" src="img/items/magic_wand_lg.png" />
              <img class="player-item" src="img/items/tpscroll_lg.png" />
            </div>
            <div class="player-kda">2/6/11</div>
          </div>
          <div class="row">
            <div class="player">
              <h3>Kuroky</h3>
              <div class="player-name">Kuro Salehi Takhasomi</div>
            </div>
            <div class="player-icons">
              <img class="player-hero" src="img/heroes/lich_hphover.png" />
              <img class="player-item" src="img/items/ward_sentry_lg.png" />
              <img class="player-item" src="img/items/tranquil_boots_lg.png" />
              <img class="player-item" src="img/items/enchanted_mango_lg.png" />
              <img class="player-item" src="img/items/medallion_of_courage_lg.png" />
              <img class="player-item" src="img/items/magic_wand_lg.png" />
              <img class="player-item" src="img/items/tpscroll_lg.png" />
            </div>
            <div class="player-kda">2/6/11</div>
          </div>
          <h2>
            <img src="img/logo.png" />
            Team Liquid
          </h2>
        </div>
      </div>
      <div id="timeline">
        <canvas id="chart"></canvas>
      </div>
      <div class="key-numbers">
        <div class="team-1">
          <em>3</em> objectifs pris (dont 0 aegis)
        </div>
        <div class="team-2">
          <em>8</em> objectifs pris (dont 2 aegis)
        </div>
      </div>
    </div>
    <script type="text/javascript">
      /* variables */

      // game length in secondes
      const gameTime = 2300;

      // objectives variables
      const t1Obj = [{
        time: 10,
        type: 'tower'
      }, {
        time: 22,
        type: 'tower'
      }, {
        time: 33,
        type: 'tower'
      }];

      const t2Obj = [{
        time: 8,
        type: 'tower'
      }, {
        time: 12,
        type: 'tower'
      }, {
        time: 14,
        type: 'tower'
      }, {
        time: 18,
        type: 'aegis'
      }, {
        time: 22,
        type: 'tower'
      }, {
        time: 25,
        type: 'tower'
      }, {
        time: 30,
        type: 'aegis'
      }, {
        time: 35,
        type: 'tower'
      }];

      // line arrays, 1point every 5 minutes
      const xp = [0, 15, -72, -20, 50, 87, 100, 42];
      const gold = [0, 23, 54, -60, 30, -57, -20, 5];


      /* canvas setup */
      let canvas = document.getElementById('chart'),
          context = canvas.getContext('2d'),
          context2 = canvas.getContext('2d'),
          width = canvas.width = document.getElementById('timeline').offsetWidth - 20,
          height = canvas.height = document.getElementById('timeline').offsetHeight,
          objectiveDistance = 250,
          timeDistance = 400,
          percentageStep = 25,
          chartScale = 2,
          legendColor = '#aaa',
          indicatorColor = '#333',
          green = '#5db255',
          white = '#fff';

      context.translate(0, height/2);
      context.scale(1, -1);

      // time indicators
      const slotNumber = Math.ceil(gameTime / 300);
      const shift = width / slotNumber;
      for (let t=0; t<=slotNumber; t++) {
        context.beginPath();
        context.moveTo(t*shift, -(timeDistance));
        context.lineTo(t*shift, timeDistance);
        context.lineWidth = 1;
        context.strokeStyle = indicatorColor;
        context.stroke();

        //prevents upside down text
        context.save();
        context.scale(1, -1);

        context.fillStyle = legendColor;
        context.fillText(t*5, t*shift, -400);

        context.restore();
      }

      /* objectives */
      const circle = 2 * Math.PI;

      function addObj(ctx, type, x, y) {
        let img = new Image();
        img.src = 'img/objectives/'+type+'.png';
        img.onload = function() {
          ctx.drawImage(img, x, y);
        }
      }

      function drawObj(objectives, distance) {
        objectives.forEach(function(o) {
          /* TODO: add pictures and fix upside down images */
          // if (o.type === 'aegis') {
          //   context.save();
          //   context.scale(1, -1);
          //   addObj(context, o.type, o.time*shift/5, -(objectiveDistance));
          //   context.restore();
          // } else {
            context.beginPath();
            context.arc(o.time*shift/5, distance, 5, 0, circle, false);
            context.fillStyle = white;
            context.fill();
            context.lineWidth = 3;
            context.strokeStyle = green;
            context.stroke();
          // }
        });
      }

      drawObj(t1Obj, objectiveDistance);
      drawObj(t2Obj, -(objectiveDistance));

      // percentage indicators
      for (let i=-100; i<=100; i=i+percentageStep) {
        context2.beginPath();
        context2.moveTo(0, i*chartScale);
        context2.lineTo(width, i*chartScale);
        context2.lineWidth = 1;
        context2.strokeStyle = indicatorColor;
        context2.stroke();

        context2.save();
        context2.scale(1, -1);

        context2.fillStyle = legendColor;
        context2.fillText(Math.abs(i), 0, i*chartScale);

        context2.restore();
      }

      // linechart for xp
      function drawLine(t, color, pointStep) {
        const stats = t;

        let left = stats.shift(),
            prevPoint = 0;

        for(stat in stats) {
          point = stats[stat];

          context2.beginPath();
          context2.moveTo(left, prevPoint*2);
          context2.lineTo(left+pointStep, point*2);
          context2.lineWidth = 5;
          context2.lineCap = 'round';
          context2.strokeStyle = color;
          context2.stroke();

          prevPoint = point;
          left += pointStep;
        }
      }

      drawLine(xp, green, shift);
      drawLine(gold, white, shift);
    </script>
  </body>
</html>
